import { ArrowDB } from "./arrow";
import { tableFromArrays, tableFromJSON } from "apache-arrow";
function isColumnar(obj) {
    return !Array.isArray(obj);
}
export class JsonDB extends ArrowDB {
    /**
     * Input a columnar object {item: [1, 2], item2: ["a", "b"], ...}
     * or a row object [{item: 1, item2: "a"}, {item: 2, item2: "b"}]
     */
    constructor(object) {
        let arrowTable;
        if (isColumnar(object)) {
            arrowTable = tableFromArrays(object);
        }
        else {
            arrowTable = tableFromJSON(object);
        }
        super(arrowTable);
    }
}
//# sourceMappingURL=json.js.map